---
layout: post
title:  Redash 쉽게 사용하기 
---

# Redash 쉽게 사용하기

얼마전 새 회사에 입사를 하면서 기존에 사용 하던 Grafana를 쓰지 못하게 되었고 기존 팀원들이 사용하던 Redash를 접하게 되었습니다. 기존 팀원들이 각자 필요에 만들어던 많은 쿼리들과 카테고리 없이 여기 저기 흩어져 있던 화면들이 나로 하여금 Redash에 대한 두려움과 거부감만 커져 가고 선뜻 손이 가지 않았습니다.

하지만 회사일이 그렇든 내가 주어진 task중에 Redash를 정리하고 팀내 하나의 대시보드로 통합하는 것이였다.

이 과제를 처리 하기 위해 Redash를 몸소 부딪힌 저의 여정입니다.

Redash는 데이터 소스에 직접 연결하여 실시간으로 쿼리하고, 시각화하며, 대시보드를 생성할 수 있는 오픈 소스 도구입니다. 이 플랫폼은 데이터 기반 의사 결정을 지원하기 위해 고안되었으며, 팀 내 데이터 접근성을 높여 데이터 주도적 문화를 촉진하는 데 도움을 줍니다.

<img src="/assets/redash.png" width="30%" height="70%"/>

Redash 웹 인터페이스를 이용 하는 입장에서는 데이터 파이프 라인에 대한 고민 없이 쿼리에 유저에게 익숙한 SQL 문법을 통해 조회만 하면 원하는 데이터를 쉽게 볼수 있는 장점이 있습니다.
오늘은 Redash 시스템이나 데이터 파이프라인이 아닌 Redash 기본 사용법, 운영, 시각화 등 유저 기준으로 Redash를 잘 이용해보는 이야기 해보겠습니다.

Redash 화면은 보통 아래의 쿼리창에서 가장 많은 작업이 진행됩니다.

<img src="/assets/redash2.png" width="70%" height="90%"/>

Redash 화면 구성 아래와 같습니다. 

<img src="/assets/redash3.png" width="60%" height="90%"/>

#### 쿼리명
해당 쿼리 이름을 작성 합니다. 쿼리명은 팀마다 네이밍 규칙을 가져야 유지보수가 쉽습니다.

쿼리 네이밍 Rule : [팀명]_[카테고리]_[컨텐츠] 예를 들어 검색_지면별_노출수분석 이렇게 표현하고 있습니다. 쿼리명 오른쪽에 Tag 와 Description을 추가 할수 있습니다. Tag를 잘 분류해 두면 쿼리 검색하고 유지보수 하기가 편리합니다.

#### 검색창
테이블명을 부분 매칭으로 검색 할수 있습니다.

#### 테이블 목록
현재 사용 가능한 테이블 목록을 검색기능을 통해 얻을수 있습니다.

#### 쿼리에디터
사용자가 쿼리를 작성하는 공간입니다. desc 명령어를 통해 테이블의 스키마를 확인하고 통상적인 sql 작성을 하고 하단에 Execute 클릭 하면 쿼리가 실행 됩니다. 쿼리를 실행하면 상태창에 현재 쿼리 진행 상태가 노출 됩니다.

```python
-- query 예시 
SELECT name, age, job, area, personality 
FROM perswon 
WHERE age > 10 
```

### 쿼리파라메터 {{}}
쿼리파마메터는 쿼리를 실행할때 주입되는 변수를 연결해주는 기능 입니다.
쿼리파라메터를 설정하면 매번 쿼리를 수정 하지 않고 UI 화면에서 선택 혹은 입력을 통해 원하는 조건의 데이터를 조회 할수 있습니다. 입력 타입은 String, number, dropdown, dateRange, Query Base dropdown list(조회 목록을 쿼리를 통해 생성)등 다양하게 설정 가능하고 조합하여 사용 할 수 있습니다.
```python
-- query number type 쿼리파라메터 적용예시
SELECT name, age, job, area, personality
FROM perswon
WHERE age > {{age}}

-- query date-range type 쿼리파라메터 적용예시
SELECT columns
FROM table_name
WHERE dt BETWEEN FORMAT_DATE('%Y%m%d', '{{date.start}}')
AND FORMAT_DATE('%Y%m%d', '{{date.end}}')
```

### 검색결과
쿼리가 실행이 완료되면 쿼리 결과가 테이블 형태로 검색결과 창에 노출 됩니다. 표 형태로 노출된 데이터는 옆에 "New Visualization" 을 클릭하고 그래프 형태로 변환 할수 있습니다.

#### New Visualization
조회된 데이터를 시각화 기능을 이용해서 차트로 시작화 할수 있습니다. 가장 먼저 차트 형태를 설정합니다. 차트는 시각화 하고자 하는 목적에 따라 적합한 타입을 선택합니다. 각 차트는 아래의 특성을 가지고 있습니다.
<img src="/assets/redash4.png" width="60%" height="90%"/>

#### 막대 차트 (Bar Chart)
* 용도: 막대 차트는 범주형 데이터의 값을 직관적으로 비교하기 위해 사용됩니다. 각 범주는 막대로 표현되며, 막대의 높이나 길이는 해당 범주의 크기를 나타냅니다. 페이지별 노출수, 섹션별 클릭수 등을 비교 분석 할수 있습니다.
* 특징: 막대 차트는 시간 순서에 따른 변화보다는 개별 범주 간의 크기 비교에 적합합니다. 수평 막대 차트는 레이블이 긴 경우 유용하며, 수직 막대 차트는 범주가 많지 않을 때 효과적입니다. 그룹화된 막대 차트나 누적 막대 차트를 사용하여 여러 범주에 걸친 데이터를 함께 비교할 수 있습니다.

#### 라인 차트 (Line Chart)
* 용도: 라인 차트는 시간에 따른 변화를 표시하는 데 주로 사용됩니다. 데이터 포인트들이 선으로 연결되어 시간의 흐름에 따른 추세를 보여줍니다. 일별 노출수, 클릭수, CTR 추이가 기본적인 예시 입니다.
* 특징: 라인 차트는 시간 경과에 따른 데이터의 트렌드, 패턴을 식별하는 데 매우 유용합니다.
여러 데이터 세트를 비교할 때 선의 색깔이나 스타일을 다르게 하여 여러 시리즈를 한 그래프에 표현할 수 있습니다. 주가 변동, 기온 변화 등 연속적인 데이터를 시각화하는 데 적합합니다.

#### 파이 차트 (Pie Chart)
* 용도: 파이 차트는 전체에서 각 부분이 차지하는 비율을 나타내는 데 사용됩니다. 각 조각의 크기는 전체에서 해당 범주의 비율을 나타냅니다. 사용자 연령분포, 진입페이지 분포 등을 볼때 유용합니다.
* 특징: 파이 차트는 각 범주가 전체에 대해 어느 정도의 비율을 차지하는지 직관적으로 보여주며, 주로 전체의 100%를 구성하는 각 부분의 비율을 시각화할 때 사용됩니다.
비율의 비교가 중요할 때 유용하지만, 많은 범주가 있거나 데이터 포인트 간 비교가 목적일 때는 혼란을 줄 수 있습니다.전체의 크기를 나누어 각각의 부분이 얼마나 되는지 보여주기 때문에, 구성 요소의 상대적 중요도를 한눈에 파악하기 좋습니다.

각 차트 유형은 데이터의 특정 측면을 강조하며, 사용 목적에 따라 선택하여 사용하는 것이 좋습니다. 데이터의 특성과 분석하고자 하는 목표에 가장 적합한 차트 유형을 선택하여 효과적인 데이터 시각화를 수행할 수 있습니다.

차트 타입을 선택 했으면 x좌표 컬럼과 y좌표 컬럼을 선택합니다. 각 축에 대한 설정은 X-Asix, Y-Axis 탭에서 개별 설정을 할수 있습니다. 데이터를 group 단위로 지정하고 싶다면 Group by 입력창에 해당 컬럼명을 입력하면 합산된 데이터로 차트를 생성할수 있습니다.

지금까지 쿼리를 생성하고 차트를 만드는 과정을 마쳤습니다. 이렇게 만들어지 쿼리는 개별로 관리되고 공유 할수 있지만 Ad-hoc이 아닌 모니터링을 위한 쿼리들은 모아 하나의 대시 보드로 구성 하는것이 일반적입니다. 지금부터 대시보드 구성을 살펴보겠습니다.

### 대시보드
<img src="/assets/redash5.png" width="60%" height="90%"/>

Dashboard : 현재 만들어진 대시보드 목록을 조회 할수 있고 쿼리와 마찬가지로 대시보드도 네이밍룰을 정해서 관리하면 대시보드가 운영이 수월해집니다. "New Dashboard" 를 클릭해서 신규 대시보드를 생성합니다.

<img src="/assets/redash6.png" width="60%" height="90%"/>

하단의 Add Widget 클릭하고 만들어 두었던 쿼리를 선택합니다. 테이블 형태와 차트 형태를 각각 선택할수 있고 위치를 조정 할수 있습니다. 해당 쿼리에 쿼리파라메터가 존재 하는 경우 해당 쿼리파라메터를 대시보드 전체 적용되는 파라메터로 할것인지 위젯에만 적용 되는 파라메터로 할것 인지 설정합니다.
대시보드 파라메터는 대시보드에 포함된 쿼리 전체에 적용되며 변경시 전체 쿼리가 재실행 됩니다. 위젯파라메터로 설정시 해당 위젯에만 반영됩니다. 같은 대시보드 내에 쿼리라고 하여도 위젯에 따라 조회 조건이 다른 경우 유용하게 사용 됩니다.

<img src="/assets/redash7.png" width="30%" height="90%"/>

AddTextBox 를 이용해 해당 대시보의 설명을 마크다운 문법을 통해 작성할수 있습니다. 대시보드에 대한 설명과 각 파라메터에 대한 설명이 상세히 기록되어 있으면 대시보드를 처음 이용하시는 유저도 쉽게 사용 가능함으로 상세히 기록해 줍니다.

대시보드가 구성 되었으면 Done Editing을 클릭하고 저장해 줍니다.

### Alert 설정
Alerts 설정에 대해서 알아보겠습니다. 회사에서는 알림 모니터링 툴이 대부분 시스템화 되어 있어서 이 기능을 잘 사용하지 않지만 그런 시스템이 구축전이라면 사용해 보는 것도 좋습니다.
알림발생을 감지할 쿼리를 선택하고 알림을 받을 메일 혹은 채널을 기재합니다. 알림은 한번반 수신하거나 매번 수신하는 등 몇가지 방법이 존재합니다. 본인에게 적절한 타입을 선택하시면 됩니다.
알림은 해당 쿼리가 실행되는 시점에 트리거 됩니다. 쿼리의 refresh 시간을 설정하면 정해진 시간 마다 알림 체크가 실행되고 알림 설정조건을 충족하면 알림이 발생 됩니다.
* 쿼리파라메터가 있는 쿼리에는 알림이 동작하지 않습니다.

이상으로 사용자 중심의 Redash 사용법을 간단히 알아보았습니다. 어떤 일이든 손에 익으려면 자꾸 해보는 방법밖에 없습니다. 지금 Redash를 사용해 볼수 있는 환경이 있다면 일단 만들어 보면 참 쉽다는 것을 알게 될것입니다.

Redash와 유사한 대시보드 및 데이터 시각화 도구로는 여러 가지가 있습니다. 다음은 몇 가지 대표적인 도구들입니다:

#### Tableau:
기능: 강력한 데이터 시각화 기능을 제공하며, 드래그 앤 드롭 인터페이스로 복잡한 데이터 분석을 쉽게 수행할 수 있습니다.
특징: 대규모 데이터 세트에 대한 빠른 처리와 다양한 데이터 소스 연결 지원이 특징입니다.
#### Power BI:
기능: Microsoft 제품군과의 높은 호환성을 제공하며, 데이터 집계, 분석, 시각화, 공유까지의 흐름을 지원합니다.
특징: Excel 사용자에게 친숙한 인터페이스를 제공하고, Azure와의 통합을 통해 확장성 있는 솔루션을 제공합니다.
#### Metabase:
기능: 오픈 소스 도구로 SQL 없이도 사용자가 데이터를 쿼리하고 시각화할 수 있게 지원합니다.
특징: 설치가 간단하며, 특히 작은 조직이나 팀에 적합합니다. 사용자 친화적인 인터페이스를 제공합니다.
#### Grafana:
기능: 주로 인프라스트럭처 및 애플리케이션 모니터링에 사용되며, 다양한 데이터 소스에서 시계열 데이터를 시각화하는 데 강점을 가지고 있습니다.
특징: 대시보드 커스터마이징이 용이하며, 알림 기능과 플러그인 시스템을 갖추고 있습니다.
이 도구들은 각각 특정 용도와 사용자 요구에 맞게 설계되었으며, 기업 환경이나 개인 프로젝트에서 다양하게 활용될 수 있습니다